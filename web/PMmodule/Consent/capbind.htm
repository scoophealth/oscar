<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Integrisign WebSign Capture</title>
</head>

<script language="javaScript">

  //The following functions needs to implemented to enable the webpages with integrisign


  //The getHashdata function will be called by applet to get the hash data.
  //e.g form fields that nedds to be included in hash should be concatinated into a single string
  //Hidden fields meant to hold integrisign data should be omitted from hash as they doesn't carry any
  //value prior to the act of signing.

  function getHashData() {
  	//In this example uid,uname field values are sent to Hash
  	//Similar way any number of form field values can be sent to hash
  	var hashstr;
  	hashstr=window.document.integrisignfrm.uid.value+window.document.integrisignfrm.uname.value+window.document.integrisignfrm.crdno.value;
  	return hashstr;
  }

  // This signnow function responsible for the capture and paint the signature on web forms.

  function signNow() {


	var a,b;
	a = new String(window.document.integrisignfrm.uid.value); //user id
	b =new String(window.document.integrisignfrm.uname.value); // name
	if(a == "" || b == "")
	{
		if(a == "" && b == "")
			alert("User ID & User Name must  be entered");
		else
		{
			 if(a == "")
			 	alert("User Id must be entered");
			 else
				alert("User Name must be entered");

		}
	}
	else
	{
		// UserId specfic to site and the users name must be passed to sign the forms

		//document.Sign.signNow(a,b);
		for(i=0;i<window.document.integrisignfrm.uid.value.length;i++)
		{
			if(window.document.integrisignfrm.uid.value.charAt(i)==" ")
			{
				alert("Id should not contain whitespace");
				return;
			}
			if(window.document.integrisignfrm.uid.value.charAt(i)=="'") {
				alert("Id should not contain single quote");
				return;

			}
		}

		if(window.document.integrisignfrm.uid.value.length>50) {
			alert("Id should not be more than 50 characters");
			return;
		}


		document.Sign.signNow(a,b,"demo","demo","demo","footer","comments",true,true,true);
		//document.Sign.signNow(a,b,true,true,true);


	}
}

// trybytes function gets the raw signature and bmp data as strings this should be
// called before submit after signnow
// The returned strings from calls to applets are assigned to form hidden fields.

function tryBytes() {
		var y;
		var z;
		isSigned = document.Sign.isSigned();
		// Information can only be extracted if isSigned() returns true
		if(isSigned == true)
		{
			// Get the signature info and assign to one of form field
			document.integrisignfrm.signstr.value=document.Sign.getString();
			x = document.integrisignfrm.signstr.value;
			// Get the bmp info and assign to one of form field
			document.integrisignfrm.bmpstr.value=document.Sign.getBMPString(x,125,60);
			y =document.integrisignfrm.bmpstr.value;
			// Get the Gif data and assign it to one of the fields
			z=document.integrisignfrm.gifstr.value=document.Sign.getGifString(x,125,60);
			jpeg=document.integrisignfrm.jpegstr.value=document.Sign.getJpegString(x,125,60,100);

			if(x != "") {
				if(y !="") {
					if(z!="") {
						if(jpeg!="") {
								document.integrisignfrm.submit();
						} else
							alert("unable to get the JPEG Info");
					} else
						alert("unable to get the Gif Info");

				} else
					alert("unable to get the BMP info");

			 } else
				alert("Unable to get The Sign String");
		}
		else
			alert("Before Submit form must be signed");
 }
 </script>
<body topmargin="0" leftmargin="0">
<table border="0" width="100%" bgcolor="#336699" height="3%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="39%">
      <b><font color="#FFFFFF" face="Century Gothic" size="4">Interlink Electronics.</font></b></td>
    <td width="61%" align="left" valign="top">
     <b><font color="#FFFFFF"><font face="Tahoma" size="3">Integrisign
      WebSign </font><font face="Arial" size="2">(Capture Bind
      demo)&nbsp;&nbsp;</font><font face="Arial" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
     </font><a href="index.htm" style="font-family: Arial; color: #FFFFFF"><font face="Arial" size="2">home</font></a></font></b>  </tr>
</table>
<table border="0" width="100%" height="284" bgcolor="#ffffff">
  <tr>
    <td width="50%" height="280" valign=top>
      <div align="left">
      <table border="0" width="98%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="100%">
            <font color="#FF0000" face="Arial"><b><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;
            </font><font size="3">Key
            features</font></b></font>
            <ul>
              <li>
                <font size="2" face="Arial" color="#008000">Easy
                to&nbsp;<span class="440201923-20092001">d</span>eploy,&nbsp;<span class="440201923-20092001">s</span>calable,&nbsp;<span class="440201923-20092001">s</span>ecure&nbsp;<span class="440201923-20092001">W</span>eb
                based&nbsp;<span class="440201923-20092001">s</span>olution.</font>
              <li>
                <font size="2" face="Arial" color="#008000">Automatic
                Client components&nbsp;<span class="440201923-20092001">i</span>nstallation
                and component updates.</font>
              <li>
                <font size="2" face="Arial" color="#008000">GIF,<span class="440201923-20092001">
                </span>JPEG,<span class="440201923-20092001"> </span>BMP, PNG images
                can be generated from biometric signature&nbsp;<span class="440201923-20092001">string
                </span>captured either at client or server.&nbsp;</font>
              <li>
                <font color="#008000"><span class="440201923-20092001"><font size="2" face="Arial">Product
                a</font></span><font size="2" face="Arial">vailable&nbsp;<span class="440201923-20092001">in</span>
                Capture&nbsp;<span class="440201923-20092001">O</span>nly,<span class="440201923-20092001">
                </span>Capture<span class="440201923-20092001"> &amp; </span>Bind,<span class="440201923-20092001">
                or </span>Capture<span class="440201923-20092001">/Verify &amp; </span>Bind<span class="440201923-20092001">
                version</span>s.</font></font>
              <li>
                <font color="#008000"><span class="440201923-20092001"><font size="2" face="Arial">Verify</font></span><font size="2" face="Arial">&nbsp;using
                Behavioral Biometrics</font></font>
              </li>
            </ul>
            <p style="margin-left: 20; margin-right: 5"><b><font face="Arial" size="3"><font color="#FF0000">Process</font><font color="#009933">&nbsp;</font></font><font face="Arial" size="4"><br>
            </font></b>
            <font size="2" face="Arial" color="#008000">Provide your ID,
            Name, Card No<span class="440201923-20092001">. (if applicable)</span>
            in the specified fields,&nbsp;<span class="440201923-20092001">s</span>ign
            the form<span class="440201923-20092001">,</span> and click on&nbsp;<span class="440201923-20092001">S</span>ubmit
            button to see the results. To check&nbsp;<span class="440201923-20092001">Content</span>
            Integrity&nbsp;<span class="440201923-20092001">(i.e., no
            unauthorized changes made),</span>&nbsp;<span class="440201923-20092001">change
            </span>any of the&nbsp;<span class="440201923-20092001">&quot;Signer
            Details&quot;</span> field values after signing<span class="440201923-20092001">,
            then click</span>&nbsp;<span class="440201923-20092001">S</span>ubmit
            button&nbsp;<span class="440201923-20092001">to</span> see the
            results.</font>
          </td>
        </tr>
      </table>
      </div>
    </td>
    <td width="55%" height="280" align="left">

    <form name="integrisignfrm" method="post" action="/OscarWAR/mod/caisiComp/sign4IntakeForm">
        <div align="center">
          <center>

        <table border="0" width="100%" cellspacing="0" cellpadding="0">
          <tr>
            <td width="100%" align="center" bgcolor="#ffffff"><font color="#ff0000" face="Arial" size="3"><b><span class="440201923-20092001">Sign</span>er
              Details&nbsp;</b></font></td>
          </tr>
        </table>

          </center>
        </div>
        <div align="center">
          <center>

        <table border="0" width="65%">
          <tr>
            <td width="50%" valign="top"><br>
              ID</td>
            <td width="50%" valign="top"><br>
              &nbsp;<input type="text" name="uid" size="20"></td>
          </tr>
          <tr>
            <td width="50%">Name</td>
            <td width="50%">&nbsp;<input type="text" name="uname" size="20"></td>
          </tr>
          <tr>
            <td width="50%">Card No</td>
            <td width="50%">&nbsp;<input type="text" name="crdno" size="20"></td>
          </tr>
          <tr>
            <td width="50%" valign="top">Signature</td>
            <td width="50%">&nbsp;
<!THE FOLLOWING IS THE ACTIVEX OBJECT WHICH IS USED IN DETECTING THE MSJVM AND SUN PLUGIN INSTALLATION STATUS -->
<OBJECT id=Status1 classid=clsid:64D90B4C-C486-455D-9FDB-37CED5C9C19C width="0" height="0" codebase="jvmdetect.cab#Version=1,0,0,2">
      <param name="useslibrary" value="JVMDetect">
      <param name="useslibrarycodebase" value="jvmdetect.cab">
      <param name="useslibraryversion" value="6,21,0,0">
</OBJECT>
<!SCRIPT TO CHECK THE PRESENCE OF MSJVM AND SUN PLUGIN -->
<SCRIPT LANGUAGE=JavaScript>
	var msjvmstatus;
	var sunpluginstatus;
	var jvmobj;
	//CHECK THE MSJVM INSTALLATION,ENABLEMENT STATUS
	msjvmstatus=window.document.Status1.GetMSJVMStatus();
	/*
		GetMSJVMStatus returns an integer value
		Description corresponding to the returned values are as follows
		0--  Microsoft JVM Succesfully Installed and Enabled for Internet Explorer.
		1--  Microsoft JVM not Installed.
		2--  Microsoft JVM installed but not enabled for Internet Explorer.
		3-- An internal error occured while reading the windows registry.
	*/
	//CHECK THE SUN PLUGIN  INSTALLATION,ENABLEMENT STATUS
	sunpluginstatus=window.document.Status1.GetSUNPluginStatus();

	/*
		GetSUNPluginStatus returns an integer value
		Description corresponding to the returned values are as follows
		0--  SUN Plug-in Succesfully Installed and Enabled for Internet Explorer.
		1--  SUN Plug-in not Installed.
		2--  SUN Plug-in installed but not enabled for Internet Explorer.
		3-- An internal error occured while reading the windows registry.
	*/
	//CHECK FOR THE RETURNED VALUES OF THE JVM STATUS
	if(msjvmstatus==0 && sunpluginstatus==0) {
		// If both the JVMs are installed then the default is set to Sun PlugIn
		writeSUNJVMTags();
		/*var msg;
		msg="Both MSJVM and SUNPlugin are installed and enabled on this machine. Disable any one of them.\n\n";
		msg=msg+"To disable the MS JVM Go To 'Tools-->Internet Options-->Advanced' and scroll down to 'Microsoft VM' section and uncheck the  'JIT compiler for virtual machine enabled' option\n\n";
		msg=msg+"To disable the Sun Plugin Go To  'Start-->Settings-->Control Panel-->Java Plug-in' in the popped up dialog click on 'Browser' tab and uncheck the 'Microsoft Internet Explorer Option'";
		msg=msg+" or Alternately start IE and Go To 'Tools-->Internet Options-->Advanced' and scroll down to Java (Sun) section and uncheck the 'use java' option.";
		alert(msg);
		*/
	} else if(msjvmstatus==0) {
		writeMSJVMTags();
	} else if(msjvmstatus==2) {
		if(sunpluginstatus ==0) {
			writeSUNJVMTags();
		} else if(sunpluginstatus ==2) {
			var msg;
			msg="MS JVM and Sun Plugin both are  installed on this machine but not enabled.\n\n";
			msg=msg+"To enable the MS JVM Go To 'Tools-->Internet Options-->Advanced' and scroll down to 'Microsoft VM' section and check the  'JIT compiler for virtual machine enabled' option\n\n";
			msg=msg+"To enable the Sun Plugin Go To  'Start-->Settings-->Control Panel-->Java Plug-in' in the popped up dialog click on 'Browser' tab and check the 'Microsoft Internet Explorer Option'";
			msg=msg+" or Alternately start IE and Go To 'Tools-->Internet Options-->Advanced' and scroll down to Java (Sun) section and check the 'use java' option.";
			alert(msg);
		} else {
			var msg;
			msg="MS JVM is  installed on this machine but not enabled \n\n";
			msg=msg+"To enable the MS JVM Go To 'Tools-->Internet Options-->Advanced' and scroll down to 'Microsoft VM' section and check the  'JIT compiler for virtual machine enabled' option";
			alert(msg);
		}
	} else if (msjvmstatus==1) {
		if(sunpluginstatus ==0) {
			writeSUNJVMTags();
		} else if (sunpluginstatus ==2) {
			var msg;
			msg="Sun PlugIn is installed on this machine but not enabled\n\n.";
			msg=msg+"To enable the Sun Plugin Go To  'Start-->Settings-->Control Panel-->Java Plug-in' in the popped up dialog click on 'Browser' tab and check the 'Microsoft Internet Explorer Option";
			msg=msg+" or Alternately start IE and Go To 'Tools-->Internet Options-->Advanced' and scroll down to Java (Sun) section and check the 'use java' option.";
			alert(msg);
		} else if (sunpluginstatus ==1) {
			alert("Neither the MS JVM nor the SUN Plugin are installed on this machine. Please install any one of them");
		} else if(sunpluginstatus ==3) {
			alert("Internal error occured while reading the Windows registry for the Sun Plugin check");
		}
	} else if (msjvmstatus==3) {
		if(sunpluginstatus ==0) {
			writeSUNJVMTags();
		} else if (sunpluginstatus ==2) {
			var msg;
			msg="Internal error occured while reading the Windows registry for the MSJVM installation\n\n";
			msg=msg+"Sun PlugIn is installed on this machine but not enabled.\n\n";
			msg=msg+"To enable the Sun Plugin Go To  'Start-->Settings-->Control Panel-->Java Plug-in' in the popped up dialog click on 'Browser' tab and check the 'Microsoft Internet Explorer Option";
			msg=msg+" or Alternately start IE and Go To 'Tools-->Internet Options-->Advanced' and scroll down to Java (Sun) section and check the 'use java' option.";
			alert(msg);
		} else if (sunpluginstatus ==1) {
			var msg;
			msg="Internal error occured while reading the Windows registry for the MSJVM installation\n\n";
			msg=msg+"SUN Plugin is not installed on this machine. Please install";
			alert(msg);
		} else if(sunpluginstatus ==3) {
			var msg;
			msg="Internal error occured while reading the Windows registry for the MSJVM installation\n";
			msg=msg+"Internal error occured while reading the Windows registry for the SUN Plugin installation.";
			alert(msg);
		}
	}
	//FUNCTION TO EMBED THE APPLET TAG WHICH IS COMPATIBLE WITH MICROSOFT JVM
	function writeMSJVMTags() {
		document.writeln('<OBJECT classid=clsid:E634B267-B8E7-406C-A308-988636B7D7E1 NAME=websignsup width=0 height=0 codebase=websignsup.cab#Version=6,21,0,0>');
		document.writeln('<param name=useslibrary value=websignsup>');
		document.writeln('<param name="useslibrarycodebase" value=websignsup.cab>');
		document.writeln('<param name="useslibraryversion" value=6,21,0,0>');

		document.writeln('</OBJECT><BR>');
		document.writeln('<APPLET CODE=integrisign.webclient.WebSign.class NAME=Sign WIDTH=140 HEIGHT=60 ID=apptag MAYSCRIPT>');
		document.writeln('<PARAM NAME=useslibrary VALUE=IntegrisignSignatureApplet>');
		document.writeln('<PARAM NAME=useslibrarycodebase VALUE=websignmsjvm.cab>');
		document.writeln('<PARAM NAME=useslibraryversion VALUE=6,21,0,0>');
		document.writeln('<PARAM NAME=borderstyle VALUE=1>');
		document.writeln('</APPLET>');
	}
	//FUNCTION TO EMBED THE OBJECT TAG S WHICH ARE COMPATIBLE WITH SUN PLUGIN
	function  writeSUNJVMTags(){
			document.writeln('<OBJECT classid=clsid:E634B267-B8E7-406C-A308-988636B7D7E1 NAME=websignsup width=0 height=0 codebase=websignsup.cab#Version=6,21,0,0>');
			document.writeln('<param name=useslibrary value=websignsup>');
			document.writeln('<param name="useslibrarycodebase" value=websignsup.cab>');
			document.writeln('<param name="useslibraryversion" value=6,21,0,0>');
			document.writeln('</OBJECT><BR>');
			document.writeln('<OBJECT classid=clsid:8AD9C840-044E-11D1-B3E9-00805F499D93 NAME=Sign width=125 height=65>');
			document.writeln('<PARAM NAME=code VALUE=integrisign.webclient.WebSign>');
			document.writeln('<PARAM NAME=archive VALUE=websignsunjvm.jar>');
			document.writeln('<PARAM NAME=scriptable VALUE=true>');
			document.writeln('<PARAM NAME=cache_option VALUE=Plugin>');
			document.writeln('<PARAM NAME=cache_archive VALUE=websignsunjvm.jar>');
			document.writeln('<PARAM NAME=cache_version VALUE=6.21.0.0>');
			document.writeln('<PARAM NAME=MAYSCRIPT VALUE=true>');
			document.writeln('<PARAM NAME=borderstyle VALUE=1>');
			document.writeln('Java Plugin not enabled');
			document.writeln('</OBJECT>');
	}
</script>

</td>
          </tr>
        </table>
          </center>
        </div>
	<!signstr hidden filed is for holding the signature string -->
	<input type="hidden" name="signstr">
	<!bmpstr hidden filed is for holding the bmpdata as string -->
	<input type="hidden" name="bmpstr">
	<!gifstr hidden filed is for holding the gif info as string -->
	<input type="hidden" name="gifstr">
	<!jpegstr hidden filed is for holding the JPEG info as string -->
	<input type="hidden" name="jpegstr">
	<!pngstr hidden filed is for holding the JPEG info as string -->
	<input type="hidden" name="pngstr">

      </form>
      <form name ="integrisignfrm2" method="POST" action="">
        <div align="center">
          <center>
        <table border="0" width="65%">
          <tr>
            <td width="40%" valign="top" align="left"><br>
            <! button which invokes the sign now call -->
              <input type="button" value="Sign Now" name="B1" onClick="signNow()">
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
            <td width="41%" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;<br>
            <! button calls the trybytes to get the signature and bmp data and finally submit the form-->
              <input type="button" value="  Submit  " name="B2" onclick="tryBytes()"></td>
          </tr>
        </table>
          </center>
        </div>
      </form>
      <p><font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></td>
  </tr>
</table>
<table border="0" width="100%" bgcolor="#336699" cellspacing="0" cellpadding="0" height="4%">
  <tr>
    <td width="100%">
      <p align="center"><b><font color="#FFFFFF" face="Tahoma" size="2">Interlink Electronics.
      </font><font color="#FFFFFF" face="Tahoma" size="1">Copyright©&nbsp;&nbsp;
      <a href="http://www.interlinkelectronics.com" style="color: #FFFFFF">www.interlinkelectronics.com</a></font></b></td>
  </tr>
</table>

</body>

</html>
